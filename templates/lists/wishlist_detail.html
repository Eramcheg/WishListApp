{% extends "base.html" %}
{% block title %}{% if object.owner.id != request.user.id%} {{ object.owner }}'s wishlist "{{ object.title }}" {% else %} {{ object.title }} {% endif %} {% endblock %}
{% block content %}
<h2 class="text-2xl font-bold mb-4"> {% if object.owner.id != request.user.id%} {{ object.owner }}'s wishlist "{{ object.title }}" {% else %} {{ object.title }} {% endif %} </h2>
<p class="mb-6 text-gray-600">{{ object.description }}</p>
<div class="mb-4 space-x-2">
    <a href="{% url 'wishlist_list' %}" class="px-3 py-1 rounded bg-gray-600 text-white">Back</a>
    {% if object.owner.id == request.user.id %}
        <a href="{% url 'wishlist_edit' object.slug %}" class="px-3 py-1 rounded bg-yellow-500 text-white">Edit</a>
        <a href="{% url 'wishlist_delete' object.slug %}" class="px-3 py-1 rounded bg-red-600 text-white">Delete</a>
    {% endif %}
    <a href="{% url 'item_create' object.slug %}" class="bg-green-500 text-white px-4 py-1 rounded mb-3 inline-block">+ New</a>
    <a href="{% url 'items_bulk_add' object.slug %}" class="bg-green-800 text-white px-4 py-1 rounded mb-3 inline-block">+ New multiple </a>
    <a href="{% url 'items_import' object.slug %}" class="bg-green-900 text-white px-4 py-1 rounded mb-3 inline-block"> Import </a>

    {% if object.owner.id == request.user.id%}
        <a href="{% url 'wishlist_access' object.slug %}" class="px-3 py-1 rounded bg-indigo-600 text-white">Add co-authors</a>
        {% if object.is_public %}<a href="{% url 'public_wl_detail' object.slug %}" class="bg-blue-500 text-white px-4 py-1 rounded mb-3 inline-block">Share open link</a>{% endif %}
        {% if object.share_token %}
            <p class="mb-2">Anyone with this link can view your wishlist:</p>
            <div class="flex items-center gap-2">
              <input class="border rounded px-2 py-1 w-full" readonly
                   value="{{ request.scheme }}://{{ request.get_host }}{% url 'wishlist_sharelink' object.share_token %}">
            </div>
            <form method="post" action="{% url 'wishlist_share' object.slug %}" class="mt-3">
              {% csrf_token %}
              <button name="revoke" value="1" class="bg-red-500 text-white px-3 py-1 rounded">
                Revoke Link
              </button>
            </form>
        {% else %}
            <form method="post" action="{% url 'wishlist_share' object.slug %}">
              {% csrf_token %}
              <button type="submit" class="bg-blue-500 text-white px-3 py-1 rounded">
                Generate Share Link
              </button>
            </form>
        {% endif %}
    {% endif %}
</div>
<h3 class="text-xl font-semibold mb-3">Items</h3>
<ul class="space-y-2">
    {% for item in object.items.all %}
        <li class="bg-white p-3 shadow rounded">
            {% if item.image_url %}
                <img alt="{{ item.title }}" src="{{ item.image_url }}" class="w-16 h-16 mr-4">
            {% endif %}
            <span class="font-medium">{{ item.title }}</span>
            {% if item.url %}
                <a href="{{ item.url }}" class="text-blue-500 ml-2">ðŸ”—</a>
            {% endif %}
            <div class="float-right space-x-2">
              <a href="{% url 'item_edit' wishlist_slug=object.slug item_slug=item.slug %}" class="text-yellow-600">Edit</a>
              <a href="{% url 'item_delete' wishlist_slug=object.slug item_slug=item.slug %}" class="text-red-600">Delete</a>
            </div>
        </li>
    {% empty %}
        <p>No items yet.</p>
    {% endfor %}
</ul>
{% endblock %}
