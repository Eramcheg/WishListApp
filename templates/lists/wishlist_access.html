{# templates/lists/wishlist_access.html #}
{% extends "base.html" %}
{% block title %}Access — {{ object.title }}{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-4">Access to «{{ object.title }}»</h2>

<form method="post" class="mb-6 flex gap-2 items-end">
  {% csrf_token %}
  <div>
    <label class="block text-sm">Username</label>
    <input name="username_or_email" class="border rounded px-2 py-1" required>
  </div>
  <div>
    <label class="block text-sm">Role</label>
    <select name="role" class="border rounded px-2 py-1">
      <option value="view">Viewer</option>
      <option value="edit">Editor</option>
    </select>
  </div>
  <button class="bg-blue-600 text-white px-3 py-2 rounded">Provide access</button>
</form>

<h3 class="font-semibold mb-2">Current coauthors</h3>
<table class="w-full border text-sm">
  <thead>
    <tr class="bg-gray-100">
      <th class="text-left p-2">User</th>
      <th class="text-left p-2">Role</th>
      <th class="p-2"></th>
    </tr>
  </thead>
  <tbody>
  {% for acc in accesses %}
    <tr class="border-t">
      <td class="p-2">{{ acc.user.username }} <span class="text-gray-500">{{ acc.user.email }}</span></td>
      <td class="p-2">{{ acc.get_role_display }}</td>
      <td class="p-2 text-right">
        <form method="post" style="display:inline">
          {% csrf_token %}
          <input type="hidden" name="revoke_user_id" value="{{ acc.user.id }}">
          <button class="text-red-600">Remove</button>
        </form>
      </td>
    </tr>
  {% empty %}
    <tr><td class="p-2" colspan="3">No one has been granted access yet.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
