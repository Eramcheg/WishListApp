{# templates/lists/wishlist_access.html #}
{% extends "base.html" %}
{% block title %}Access — {{ object.title }}{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-4">Access to «{{ object.title }}»</h2>

<form method="post" class="mb-6 flex gap-2 items-end">
  {% csrf_token %}
  <div class="form-field">
    <label class="block text-sm">Username</label>
    <input name="username_or_email" class="inp-text" required>
  </div>
  <div class="form-field">
    <label class="block text-sm">Role</label>
    <select name="role" class="select">
      <option value="view">Viewer</option>
      <option value="edit">Editor</option>
    </select>
  </div>
  <button class="btn-primary btn">Provide access</button>
<a href="{{ cancel_url }}" class="btn-secondary btn ">Back to detailed page</a>
</form>
<h3 class="font-semibold mb-2">Current coauthors</h3>
<table class="table table-striped table-hover rounded-md overflow-hidden border border-border">
  <thead>
    <tr>
      <th>User</th>
      <th>Role</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  {% for acc in accesses %}
    <tr class="border-t">
      <td>{{ acc.user.username }} <span class="text-muted">{{ acc.user.email }}</span></td>
      <td>{{ acc.get_role_display }}</td>
      <td>
        <form method="post" style="display:inline">
          {% csrf_token %}
          <input type="hidden" name="revoke_user_id" value="{{ acc.user.id }}">
          <button class="text-btn-danger">Remove</button>
        </form>
      </td>
    </tr>
  {% empty %}
    <tr><td class="p-2" colspan="3">No one has been granted access yet.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
