{# templates/lists/shared_with_me.html #}
{% extends "base.html" %}
{% load permissions %}
{% block title %}Shared with me{% endblock %}
{% block content %}
    {% include "partials/tabs.html" with tabs=tabs active="shared" aria_label="Shared" %}
    <h2 class="text-2xl font-bold mb-4 text-text">Wishlists that are shared with me</h2>

    {% include "partials/list_filters.html" %}

    <ul class="space-y-2">
      {% for wl in wishlists %}
           {% url 'public_wl_detail' wl.slug as open_url %}
           {% url 'wishlist_detail' wl.slug as edit_url %}
           {% with full_title=wl.title|add:" by "|add:wl.owner.username %}
               {% if wl|can_edit:request.user %}
                  {% with action_html='<a href="'|add:open_url|add:'" class="btn btn-secondary btn-xsm">View</a> <a href="'|add:edit_url|add:'" class="btn btn-primary btn-xsm">Edit</a>' %}
                      <li>
                         {% include "partials/card_row.html" with image_url=wl.image_url icon="gift" title=full_title subtitle=wl.description|default:"No description" actions=action_html%}
                       </li>
                  {% endwith %}
               {% else %}
                  {% with action_html='<a href="'|add:open_url|add:'" class="btn btn-secondary btn-xsm">View</a>' %}
                      <li>
                         {% include "partials/card_row.html" with image_url=wl.image_url icon="gift" title=full_title subtitle=wl.description|default:"No description" actions=action_html%}
                      </li>
                   {% endwith %}
               {% endif %}
           {% endwith %}
      {% empty %}
          {% include "partials/empty_state.html" with text="Wait until someone adds you as a co-author to their wishlist."%}
      {% endfor %}
    </ul>
{% endblock %}